{{ header }}{{ column_left }}
<div id="content">
  <div class="page-header">
    <div class="container-fluid">
      <div class="pull-right">
        <button type="button" id="button-bulk-sync" data-toggle="tooltip" title="Execute Bulk Sync" class="btn btn-success">
          <i class="fa fa-refresh"></i> Bulk Sync
        </button>
        <button type="button" id="button-connectivity-test" data-toggle="tooltip" title="Test Connectivity" class="btn btn-warning">
          <i class="fa fa-wifi"></i> Test Connectivity
        </button>
        <button type="button" id="button-integration-report" data-toggle="tooltip" title="Generate Integration Report" class="btn btn-info">
          <i class="fa fa-file-text"></i> Generate Report
        </button>
      </div>
      <h1>üöÄ Marketplace Integration Excellence - ATOM-M012</h1>
      <ul class="breadcrumb">
        {% for breadcrumb in breadcrumbs %}
        <li><a href="{{ breadcrumb.href }}">{{ breadcrumb.text }}</a></li>
        {% endfor %}
      </ul>
    </div>
  </div>
  
  <div class="container-fluid">
    <!-- Integration Status Overview -->
    <div class="row">
      <div class="col-lg-3 col-md-6">
        <div class="panel panel-primary">
          <div class="panel-heading">
            <div class="row">
              <div class="col-xs-3">
                <i class="fa fa-shopping-cart fa-5x"></i>
              </div>
              <div class="col-xs-9 text-right">
                <div class="huge" id="n11-progress">97.2%</div>
                <div>N11 Integration</div>
              </div>
            </div>
          </div>
          <div class="panel-footer">
            <span class="pull-left">Target: 100%</span>
            <span class="pull-right">
              <i class="fa fa-arrow-up text-warning"></i>
            </span>
            <div class="clearfix"></div>
          </div>
        </div>
      </div>
      
      <div class="col-lg-3 col-md-6">
        <div class="panel panel-success">
          <div class="panel-heading">
            <div class="row">
              <div class="col-xs-3">
                <i class="fa fa-store fa-5x"></i>
              </div>
              <div class="col-xs-9 text-right">
                <div class="huge" id="hepsiburada-progress">83.4%</div>
                <div>Hepsiburada</div>
              </div>
            </div>
          </div>
          <div class="panel-footer">
            <span class="pull-left">Target: 95%</span>
            <span class="pull-right">
              <i class="fa fa-arrow-up text-warning"></i>
            </span>
            <div class="clearfix"></div>
          </div>
        </div>
      </div>
      
      <div class="col-lg-3 col-md-6">
        <div class="panel panel-info">
          <div class="panel-heading">
            <div class="row">
              <div class="col-xs-3">
                <i class="fa fa-trending-up fa-5x"></i>
              </div>
              <div class="col-xs-9 text-right">
                <div class="huge" id="trendyol-progress">80.0%</div>
                <div>Trendyol</div>
              </div>
            </div>
          </div>
          <div class="panel-footer">
            <span class="pull-left">Target: 95%</span>
            <span class="pull-right">
              <i class="fa fa-arrow-up text-info"></i>
            </span>
            <div class="clearfix"></div>
          </div>
        </div>
      </div>
      
      <div class="col-lg-3 col-md-6">
        <div class="panel panel-warning">
          <div class="panel-heading">
            <div class="row">
              <div class="col-xs-3">
                <i class="fa fa-globe fa-5x"></i>
              </div>
              <div class="col-xs-9 text-right">
                <div class="huge" id="ozon-progress">65.0%</div>
                <div>Ozon</div>
              </div>
            </div>
          </div>
          <div class="panel-footer">
            <span class="pull-left">Target: 85%</span>
            <span class="pull-right">
              <i class="fa fa-arrow-up text-warning"></i>
            </span>
            <div class="clearfix"></div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Integration Actions -->
    <div class="row">
      <div class="col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">üéØ N11 Integration Completion (97.2% ‚Üí 100%)</h3>
          </div>
          <div class="panel-body">
            <div class="row">
              <div class="col-md-6">
                <button type="button" id="complete-n11" class="btn btn-primary btn-block">
                  <i class="fa fa-check-circle"></i> Complete N11 Integration
                </button>
              </div>
              <div class="col-md-6">
                <div class="completion-features">
                  <small>
                    <i class="fa fa-check text-success"></i> Advanced Product Mapping<br>
                    <i class="fa fa-check text-success"></i> Bulk Operations Optimization<br>
                    <i class="fa fa-check text-success"></i> Real-time Inventory Sync<br>
                    <i class="fa fa-check text-success"></i> Automated Pricing Rules
                  </small>
                </div>
              </div>
            </div>
            <div class="progress mt-3">
              <div class="progress-bar progress-bar-primary" style="width: 97.2%">
                <span>97.2% Complete</span>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">üìà Hepsiburada Integration Advancement (83.4% ‚Üí 95%)</h3>
          </div>
          <div class="panel-body">
            <div class="row">
              <div class="col-md-6">
                <button type="button" id="advance-hepsiburada" class="btn btn-success btn-block">
                  <i class="fa fa-rocket"></i> Advance Hepsiburada
                </button>
              </div>
              <div class="col-md-6">
                <div class="advancement-features">
                  <small>
                    <i class="fa fa-plus text-info"></i> Product Catalog Enhancement<br>
                    <i class="fa fa-plus text-info"></i> Variant Management System<br>
                    <i class="fa fa-plus text-info"></i> Advanced Shipping Integration<br>
                    <i class="fa fa-plus text-info"></i> Mobile App Integration
                  </small>
                </div>
              </div>
            </div>
            <div class="progress mt-3">
              <div class="progress-bar progress-bar-success" style="width: 83.4%">
                <span>83.4% Complete</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="row">
      <div class="col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">‚ö° Trendyol Integration Optimization (80% ‚Üí 95%)</h3>
          </div>
          <div class="panel-body">
            <div class="row">
              <div class="col-md-6">
                <button type="button" id="optimize-trendyol" class="btn btn-info btn-block">
                  <i class="fa fa-cogs"></i> Optimize Trendyol
                </button>
              </div>
              <div class="col-md-6">
                <div class="optimization-features">
                  <small>
                    <i class="fa fa-gear text-warning"></i> Webhook System Optimization<br>
                    <i class="fa fa-gear text-warning"></i> Bulk Operations Enhancement<br>
                    <i class="fa fa-gear text-warning"></i> Real-time Analytics<br>
                    <i class="fa fa-gear text-warning"></i> Revenue Maximization
                  </small>
                </div>
              </div>
            </div>
            <div class="progress mt-3">
              <div class="progress-bar progress-bar-info" style="width: 80%">
                <span>80% Complete</span>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">üåç Ozon Integration Advancement (65% ‚Üí 85%)</h3>
          </div>
          <div class="panel-body">
            <div class="row">
              <div class="col-md-6">
                <button type="button" id="advance-ozon" class="btn btn-warning btn-block">
                  <i class="fa fa-globe"></i> Advance Ozon
                </button>
              </div>
              <div class="col-md-6">
                <div class="ozon-features">
                  <small>
                    <i class="fa fa-star text-warning"></i> Product Catalog Completion<br>
                    <i class="fa fa-star text-warning"></i> Logistics Integration<br>
                    <i class="fa fa-star text-warning"></i> Payment System Integration<br>
                    <i class="fa fa-star text-warning"></i> Multi-language Support
                  </small>
                </div>
              </div>
            </div>
            <div class="progress mt-3">
              <div class="progress-bar progress-bar-warning" style="width: 65%">
                <span>65% Complete</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Integration Automation -->
    <div class="row">
      <div class="col-lg-8">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">ü§ñ Integration Automation Enhancement</h3>
          </div>
          <div class="panel-body">
            <div class="row">
              <div class="col-md-3">
                <button type="button" id="enhance-automation" class="btn btn-primary btn-block">
                  <i class="fa fa-magic"></i> Enhance Automation
                </button>
              </div>
              <div class="col-md-9">
                <div class="automation-features">
                  <div class="row">
                    <div class="col-md-4">
                      <strong>Workflow Automation</strong><br>
                      <small>Product sync, inventory management, order processing automation</small>
                    </div>
                    <div class="col-md-4">
                      <strong>Intelligent Features</strong><br>
                      <small>AI-powered categorization, smart pricing, predictive inventory</small>
                    </div>
                    <div class="col-md-4">
                      <strong>Integration Orchestration</strong><br>
                      <small>Multi-marketplace sync, unified dashboard, centralized management</small>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="col-lg-4">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">üìä Cross-Platform Analytics</h3>
          </div>
          <div class="panel-body">
            <button type="button" id="implement-analytics" class="btn btn-info btn-block mb-3">
              <i class="fa fa-line-chart"></i> Implement Analytics
            </button>
            <div class="analytics-features">
              <small>
                <i class="fa fa-check text-success"></i> Unified Reporting<br>
                <i class="fa fa-check text-success"></i> Business Intelligence<br>
                <i class="fa fa-check text-success"></i> Real-time Monitoring<br>
                <i class="fa fa-check text-success"></i> Comparative Analysis
              </small>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Marketplace Performance Dashboard -->
    <div class="row">
      <div class="col-lg-8">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">üìà Marketplace Performance Metrics</h3>
          </div>
          <div class="panel-body">
            <div class="table-responsive">
              <table class="table table-striped">
                <thead>
                  <tr>
                    <th>Marketplace</th>
                    <th>Response Time</th>
                    <th>Success Rate</th>
                    <th>Throughput/Hour</th>
                    <th>Accuracy</th>
                    <th>Uptime</th>
                    <th>Status</th>
                  </tr>
                </thead>
                <tbody id="performance-metrics">
                  {% if marketplace_performance %}
                    {% for performance in marketplace_performance %}
                      <tr>
                        <td><strong>{{ performance.marketplace|upper }}</strong></td>
                        <td>{{ performance.avg_response_time|round(1) }}ms</td>
                        <td>
                          <span class="label {% if performance.avg_success_rate >= 98 %}label-success{% elseif performance.avg_success_rate >= 95 %}label-warning{% else %}label-danger{% endif %}">
                            {{ performance.avg_success_rate|round(1) }}%
                          </span>
                        </td>
                        <td>{{ performance.avg_throughput|round(0) }}</td>
                        <td>{{ performance.avg_accuracy|round(1) }}%</td>
                        <td>{{ performance.avg_uptime|round(1) }}%</td>
                        <td>
                          <span class="label label-success">
                            <i class="fa fa-check"></i> Active
                          </span>
                        </td>
                      </tr>
                    {% endfor %}
                  {% else %}
                    <tr>
                      <td colspan="7" class="text-center text-muted">Loading performance data...</td>
                    </tr>
                  {% endif %}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
      
      <div class="col-lg-4">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">üîÑ Automation Efficiency</h3>
          </div>
          <div class="panel-body" style="max-height: 300px; overflow-y: auto;">
            {% if automation_metrics %}
              {% for automation in automation_metrics %}
                <div class="automation-item mb-2">
                  <div class="row">
                    <div class="col-xs-8">
                      <strong>{{ automation.marketplace|upper }}</strong><br>
                      <small class="text-muted">{{ automation.total_rules }} rules, {{ automation.total_executions }} executions</small>
                    </div>
                    <div class="col-xs-4 text-right">
                      <span class="label {% if automation.success_rate >= 98 %}label-success{% elseif automation.success_rate >= 95 %}label-warning{% else %}label-danger{% endif %}">
                        {{ automation.success_rate|round(1) }}%
                      </span>
                    </div>
                  </div>
                  <div class="progress progress-sm">
                    <div class="progress-bar progress-bar-success" style="width: {{ automation.success_rate }}%"></div>
                  </div>
                  <hr>
                </div>
              {% endfor %}
            {% else %}
              <div class="text-center text-muted">
                <i class="fa fa-cogs fa-3x"></i>
                <p>Loading automation metrics...</p>
              </div>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
    
    <!-- Sync Statistics -->
    <div class="row">
      <div class="col-lg-12">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">üìä Synchronization Statistics (Last 7 Days)</h3>
          </div>
          <div class="panel-body">
            <div class="row">
              {% if sync_statistics %}
                {% for sync in sync_statistics %}
                  <div class="col-md-3">
                    <div class="sync-card">
                      <h4>{{ sync.marketplace|upper }}</h4>
                      <div class="sync-stats">
                        <div class="stat-item">
                          <span class="stat-label">Total Syncs:</span>
                          <span class="stat-value">{{ sync.total_syncs }}</span>
                        </div>
                        <div class="stat-item">
                          <span class="stat-label">Records Processed:</span>
                          <span class="stat-value">{{ sync.total_records|number_format }}</span>
                        </div>
                        <div class="stat-item">
                          <span class="stat-label">Success Rate:</span>
                          <span class="stat-value text-success">{{ ((sync.successful_records / sync.total_records) * 100)|round(1) }}%</span>
                        </div>
                        <div class="stat-item">
                          <span class="stat-label">Avg. Execution:</span>
                          <span class="stat-value">{{ sync.avg_execution_time|round(1) }}s</span>
                        </div>
                      </div>
                      <div class="progress">
                        <div class="progress-bar progress-bar-success" style="width: {{ ((sync.successful_records / sync.total_records) * 100)|round(1) }}%">
                        </div>
                      </div>
                    </div>
                  </div>
                {% endfor %}
              {% else %}
                <div class="col-md-12">
                  <div class="text-center text-muted">
                    <i class="fa fa-spinner fa-spin fa-3x"></i>
                    <p>Loading synchronization statistics...</p>
                  </div>
                </div>
              {% endif %}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Integration Report Modal -->
<div class="modal fade" id="integration-report-modal" tabindex="-1" role="dialog">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">üìä Integration Performance Report</h4>
      </div>
      <div class="modal-body">
        <div id="integration-report-results">
          <div class="text-center">
            <i class="fa fa-spinner fa-spin fa-3x"></i>
            <p>Generating comprehensive integration report...</p>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- Connectivity Test Modal -->
<div class="modal fade" id="connectivity-test-modal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">üîó Marketplace Connectivity Test</h4>
      </div>
      <div class="modal-body">
        <div id="connectivity-test-results">
          <div class="text-center">
            <i class="fa fa-spinner fa-spin fa-3x"></i>
            <p>Testing marketplace connections...</p>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">
$(document).ready(function() {
    // Complete N11 Integration
    $('#complete-n11').click(function() {
        $(this).prop('disabled', true).html('<i class="fa fa-spinner fa-spin"></i> Completing...');
        
        $.ajax({
            url: 'index.php?route=extension/module/marketplace_integration_excellence/completeN11Integration&user_token={{ user_token }}',
            type: 'POST',
            dataType: 'json',
            success: function(response) {
                if (response.success) {
                    showAlert('success', 'N11 integration completed successfully to 100%!');
                    updateProgressBar('n11-progress', 100.0);
                    displayIntegrationResults(response.integration_results);
                } else {
                    showAlert('danger', 'Error: ' + response.error);
                }
            },
            complete: function() {
                $('#complete-n11').prop('disabled', false).html('<i class="fa fa-check-circle"></i> Complete N11 Integration');
            }
        });
    });
    
    // Advance Hepsiburada Integration
    $('#advance-hepsiburada').click(function() {
        $(this).prop('disabled', true).html('<i class="fa fa-spinner fa-spin"></i> Advancing...');
        
        $.ajax({
            url: 'index.php?route=extension/module/marketplace_integration_excellence/advanceHepsiburadaIntegration&user_token={{ user_token }}',
            type: 'POST',
            dataType: 'json',
            success: function(response) {
                if (response.success) {
                    showAlert('success', 'Hepsiburada integration advanced successfully to 95%!');
                    updateProgressBar('hepsiburada-progress', 95.0);
                } else {
                    showAlert('danger', 'Error: ' + response.error);
                }
            },
            complete: function() {
                $('#advance-hepsiburada').prop('disabled', false).html('<i class="fa fa-rocket"></i> Advance Hepsiburada');
            }
        });
    });
    
    // Optimize Trendyol Integration
    $('#optimize-trendyol').click(function() {
        $(this).prop('disabled', true).html('<i class="fa fa-spinner fa-spin"></i> Optimizing...');
        
        $.ajax({
            url: 'index.php?route=extension/module/marketplace_integration_excellence/optimizeTrendyolIntegration&user_token={{ user_token }}',
            type: 'POST',
            dataType: 'json',
            success: function(response) {
                if (response.success) {
                    showAlert('success', 'Trendyol integration optimized successfully to 95%!');
                    updateProgressBar('trendyol-progress', 95.0);
                } else {
                    showAlert('danger', 'Error: ' + response.error);
                }
            },
            complete: function() {
                $('#optimize-trendyol').prop('disabled', false).html('<i class="fa fa-cogs"></i> Optimize Trendyol');
            }
        });
    });
    
    // Advance Ozon Integration
    $('#advance-ozon').click(function() {
        $(this).prop('disabled', true).html('<i class="fa fa-spinner fa-spin"></i> Advancing...');
        
        $.ajax({
            url: 'index.php?route=extension/module/marketplace_integration_excellence/advanceOzonIntegration&user_token={{ user_token }}',
            type: 'POST',
            dataType: 'json',
            success: function(response) {
                if (response.success) {
                    showAlert('success', 'Ozon integration advanced successfully to 85%!');
                    updateProgressBar('ozon-progress', 85.0);
                } else {
                    showAlert('danger', 'Error: ' + response.error);
                }
            },
            complete: function() {
                $('#advance-ozon').prop('disabled', false).html('<i class="fa fa-globe"></i> Advance Ozon');
            }
        });
    });
    
    // Enhance Integration Automation
    $('#enhance-automation').click(function() {
        $(this).prop('disabled', true).html('<i class="fa fa-spinner fa-spin"></i> Enhancing...');
        
        $.ajax({
            url: 'index.php?route=extension/module/marketplace_integration_excellence/enhanceIntegrationAutomation&user_token={{ user_token }}',
            type: 'POST',
            dataType: 'json',
            success: function(response) {
                if (response.success) {
                    showAlert('success', 'Integration automation enhanced successfully!');
                } else {
                    showAlert('danger', 'Error: ' + response.error);
                }
            },
            complete: function() {
                $('#enhance-automation').prop('disabled', false).html('<i class="fa fa-magic"></i> Enhance Automation');
            }
        });
    });
    
    // Implement Cross-Platform Analytics
    $('#implement-analytics').click(function() {
        $(this).prop('disabled', true).html('<i class="fa fa-spinner fa-spin"></i> Implementing...');
        
        $.ajax({
            url: 'index.php?route=extension/module/marketplace_integration_excellence/implementCrossPlatformAnalytics&user_token={{ user_token }}',
            type: 'POST',
            dataType: 'json',
            success: function(response) {
                if (response.success) {
                    showAlert('success', 'Cross-platform analytics implemented successfully!');
                } else {
                    showAlert('danger', 'Error: ' + response.error);
                }
            },
            complete: function() {
                $('#implement-analytics').prop('disabled', false).html('<i class="fa fa-line-chart"></i> Implement Analytics');
            }
        });
    });
    
    // Execute Bulk Sync
    $('#button-bulk-sync').click(function() {
        if (confirm('Are you sure you want to execute bulk synchronization across all active marketplaces?')) {
            $(this).prop('disabled', true).html('<i class="fa fa-spinner fa-spin"></i> Syncing...');
            
            $.ajax({
                url: 'index.php?route=extension/module/marketplace_integration_excellence/executeBulkSync&user_token={{ user_token }}',
                type: 'POST',
                dataType: 'json',
                success: function(response) {
                    if (response.success) {
                        showAlert('success', 'Bulk synchronization completed successfully!');
                    } else {
                        showAlert('danger', 'Error: ' + response.error);
                    }
                },
                complete: function() {
                    $('#button-bulk-sync').prop('disabled', false).html('<i class="fa fa-refresh"></i> Bulk Sync');
                }
            });
        }
    });
    
    // Test Connectivity
    $('#button-connectivity-test').click(function() {
        $('#connectivity-test-modal').modal('show');
        
        $.ajax({
            url: 'index.php?route=extension/module/marketplace_integration_excellence/testIntegrationConnectivity&user_token={{ user_token }}',
            type: 'POST',
            dataType: 'json',
            success: function(response) {
                if (response.success) {
                    displayConnectivityResults(response.connectivity_results);
                } else {
                    $('#connectivity-test-results').html('<div class="alert alert-danger">Error: ' + response.error + '</div>');
                }
            }
        });
    });
    
    // Generate Integration Report
    $('#button-integration-report').click(function() {
        $('#integration-report-modal').modal('show');
        
        $.ajax({
            url: 'index.php?route=extension/module/marketplace_integration_excellence/generateIntegrationReport&user_token={{ user_token }}',
            type: 'GET',
            dataType: 'json',
            success: function(response) {
                if (response.success) {
                    displayIntegrationReport(response.report);
                } else {
                    $('#integration-report-results').html('<div class="alert alert-danger">Error: ' + response.error + '</div>');
                }
            }
        });
    });
    
    // Helper functions
    function showAlert(type, message) {
        var alertHtml = '<div class="alert alert-' + type + ' alert-dismissible">' +
                       '<button type="button" class="close" data-dismiss="alert">&times;</button>' +
                       message + '</div>';
        $('.container-fluid').prepend(alertHtml);
        
        setTimeout(function() {
            $('.alert').fadeOut();
        }, 5000);
    }
    
    function updateProgressBar(elementId, progress) {
        $('#' + elementId).text(progress + '%');
        // Update progress bar if exists
        var progressBar = $('#' + elementId).closest('.panel').find('.progress-bar');
        if (progressBar.length) {
            progressBar.css('width', progress + '%').find('span').text(progress + '% Complete');
        }
    }
    
    function displayIntegrationResults(results) {
        console.log('Integration Results:', results);
        // Display results in a modal or update dashboard
    }
    
    function displayConnectivityResults(results) {
        var html = '<div class="row">';
        
        $.each(results, function(marketplace, result) {
            var statusClass = result.status === 'connected' ? 'success' : 'danger';
            var statusIcon = result.status === 'connected' ? 'check' : 'times';
            
            html += '<div class="col-md-6 mb-3">' +
                   '<div class="panel panel-' + statusClass + '">' +
                   '<div class="panel-heading">' +
                   '<h4><i class="fa fa-' + statusIcon + '"></i> ' + marketplace.toUpperCase() + '</h4>' +
                   '</div>' +
                   '<div class="panel-body">' +
                   '<p><strong>Status:</strong> ' + result.status + '</p>' +
                   '<p><strong>Response Time:</strong> ' + result.response_time + '</p>' +
                   '<p><strong>API Status:</strong> ' + result.api_status + '</p>' +
                   '<p><strong>Last Test:</strong> ' + result.last_test + '</p>' +
                   '</div>' +
                   '</div>' +
                   '</div>';
        });
        
        html += '</div>';
        
        $('#connectivity-test-results').html(html);
    }
    
    function displayIntegrationReport(report) {
        var html = '<div class="row">' +
                  '<div class="col-md-12">' +
                  '<h4>Executive Summary</h4>' +
                  '<p>Report generated at: ' + report.generated_at + '</p>' +
                  '<p>Time period: ' + report.time_period + '</p>' +
                  '</div>' +
                  '</div>';
        
        if (report.integration_status) {
            html += '<div class="row">' +
                   '<div class="col-md-12">' +
                   '<h4>Integration Status</h4>' +
                   '<div class="table-responsive">' +
                   '<table class="table table-striped">' +
                   '<thead><tr><th>Marketplace</th><th>Progress</th><th>Status</th><th>Performance</th></tr></thead>' +
                   '<tbody>';
            
            report.integration_status.forEach(function(status) {
                html += '<tr>' +
                       '<td>' + status.marketplace.toUpperCase() + '</td>' +
                       '<td>' + status.integration_progress + '%</td>' +
                       '<td><span class="label label-' + (status.status === 'active' ? 'success' : 'warning') + '">' + status.status + '</span></td>' +
                       '<td>' + status.performance_score + '%</td>' +
                       '</tr>';
            });
            
            html += '</tbody></table></div></div></div>';
        }
        
        $('#integration-report-results').html(html);
    }
    
    // Auto-refresh integration analytics every 60 seconds
    function refreshIntegrationAnalytics() {
        $.ajax({
            url: 'index.php?route=extension/module/marketplace_integration_excellence/getIntegrationAnalytics&user_token={{ user_token }}',
            type: 'GET',
            dataType: 'json',
            success: function(response) {
                if (response.success) {
                    updateDashboardMetrics(response.analytics);
                }
            }
        });
    }
    
    function updateDashboardMetrics(analytics) {
        // Update real-time dashboard metrics
        if (analytics.marketplace_status) {
            // Update marketplace progress indicators
            console.log('Analytics updated:', analytics);
        }
    }
    
    // Update analytics every 60 seconds
    setInterval(refreshIntegrationAnalytics, 60000);
    
    // Initial load
    refreshIntegrationAnalytics();
});
</script>

<style>
.huge {
    font-size: 40px;
}

.panel-primary .huge, .panel-success .huge, .panel-info .huge, .panel-warning .huge {
    color: #fff;
}

.completion-features, .advancement-features, .optimization-features, .ozon-features, .analytics-features {
    font-size: 12px;
    line-height: 1.4;
}

.automation-features {
    font-size: 13px;
}

.sync-card {
    text-align: center;
    padding: 15px;
    border: 1px solid #ddd;
    border-radius: 5px;
    margin-bottom: 15px;
    background-color: #f9f9f9;
}

.sync-card h4 {
    margin-top: 0;
    color: #337ab7;
}

.stat-item {
    display: flex;
    justify-content: space-between;
    margin-bottom: 5px;
    font-size: 12px;
}

.stat-label {
    font-weight: normal;
    color: #666;
}

.stat-value {
    font-weight: bold;
}

.automation-item {
    border-left: 3px solid #ddd;
    padding-left: 10px;
}

.progress-sm {
    height: 10px;
}

.mt-3 {
    margin-top: 15px;
}

.mb-2 {
    margin-bottom: 10px;
}

.mb-3 {
    margin-bottom: 15px;
}

.table th {
    background-color: #f5f5f5;
    font-weight: bold;
}

.label {
    font-size: 11px;
}

.panel-heading h3 {
    margin: 0;
    font-size: 16px;
}

.panel-heading h4 {
    margin: 0;
    font-size: 14px;
}
</style>

{{ footer }}