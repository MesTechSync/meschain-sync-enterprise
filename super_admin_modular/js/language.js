/**
 * MesChain-Sync Super Admin Panel - Language System Module
 * Version: 4.1
 * Description: Multi-language support system with translations
 */

// Translation data
const translations = {
    tr: {
        // Header
        'headerTitle': 'MesChain-Sync Süper Admin Dashboard',
        'headerSubtitle': 'Süper Admin Dashboard v4.1',
        'quickAccess': 'Hızlı Erişim',
        'usageGuide': 'Kullanım Kılavuzu', 
        'techManual': 'Teknik Kılavuz',
        'systemReport': 'Sistem Raporu',
        'backupManager': 'Yedek Yöneticisi',
        'themes': 'Temalar',
        'light': 'Aydınlık',
        'dark': 'Karanlık',
        'connecting': 'Bağlanıyor...',
        'systemHealthy': 'Sistem Sağlıklı',
        'superAdmin': 'Süper Admin',
        'fullAccess': 'Tam Erişim',
        
        // Navigation
        'dashboard': 'Dashboard',
        'systemAnalytics': 'Sistem Analizi',
        'userManagement': 'Kullanıcı Yönetimi',
        'apiManagement': 'API Yönetimi',
        'systemMonitoring': 'Sistem İzleme',
        'securityCenter': 'Güvenlik Merkezi',
        'settings': 'Ayarlar',
        'systemLogs': 'Sistem Logları',
        
        // Dashboard Metrics
        'totalUsers': 'Toplam Kullanıcı',
        'activeSystems': 'Aktif Sistemler',
        'securityScore': 'Güvenlik Skoru',
        'systemPerformance': 'Sistem Performansı',
        'activeConnections': 'Aktif Bağlantılar',
        'totalTransactions': 'Toplam İşlemler',
        'monthlyRevenue': 'Aylık Gelir',
        'avgResponseTime': 'Ortalama Yanıt Süresi',
        
        // System Status
        'online': 'Çevrimiçi',
        'offline': 'Çevrimdışı',
        'maintenance': 'Bakım',
        'active': 'Aktif',
        'inactive': 'Pasif',
        'critical': 'Kritik',
        'warning': 'Uyarı',
        'success': 'Başarılı',
        
        // Buttons
        'save': 'Kaydet',
        'cancel': 'İptal',
        'delete': 'Sil',
        'edit': 'Düzenle',
        'add': 'Ekle',
        'refresh': 'Yenile',
        'export': 'Dışa Aktar',
        'import': 'İçe Aktar',
        'backup': 'Yedekle',
        'restore': 'Geri Yükle'
    },
    en: {
        // Header
        'headerTitle': 'MesChain-Sync Super Admin Dashboard',
        'headerSubtitle': 'Super Admin Dashboard v4.1',
        'quickAccess': 'Quick Access',
        'usageGuide': 'Usage Guide',
        'techManual': 'Technical Manual',
        'systemReport': 'System Report',
        'backupManager': 'Backup Manager',
        'themes': 'Themes',
        'light': 'Light',
        'dark': 'Dark',
        'connecting': 'Connecting...',
        'systemHealthy': 'System Healthy',
        'superAdmin': 'Super Admin',
        'fullAccess': 'Full Access',
        
        // Navigation
        'dashboard': 'Dashboard',
        'systemAnalytics': 'System Analytics',
        'userManagement': 'User Management',
        'apiManagement': 'API Management',
        'systemMonitoring': 'System Monitoring',
        'securityCenter': 'Security Center',
        'settings': 'Settings',
        'systemLogs': 'System Logs',
        
        // Dashboard Metrics
        'totalUsers': 'Total Users',
        'activeSystems': 'Active Systems',
        'securityScore': 'Security Score',
        'systemPerformance': 'System Performance',
        'activeConnections': 'Active Connections',
        'totalTransactions': 'Total Transactions',
        'monthlyRevenue': 'Monthly Revenue',
        'avgResponseTime': 'Average Response Time',
        
        // System Status
        'online': 'Online',
        'offline': 'Offline',
        'maintenance': 'Maintenance',
        'active': 'Active',
        'inactive': 'Inactive',
        'critical': 'Critical',
        'warning': 'Warning',
        'success': 'Success',
        
        // Buttons
        'save': 'Save',
        'cancel': 'Cancel',
        'delete': 'Delete',
        'edit': 'Edit',
        'add': 'Add',
        'refresh': 'Refresh',
        'export': 'Export',
        'import': 'Import',
        'backup': 'Backup',
        'restore': 'Restore'
    },
    de: {
        // Header
        'headerTitle': 'MesChain-Sync Super Admin Dashboard',
        'headerSubtitle': 'Super Admin Dashboard v4.1',
        'quickAccess': 'Schnellzugriff',
        'usageGuide': 'Benutzerhandbuch',
        'techManual': 'Technisches Handbuch',
        'systemReport': 'Systembericht',
        'backupManager': 'Backup-Manager',
        'themes': 'Themen',
        'light': 'Hell',
        'dark': 'Dunkel',
        'connecting': 'Verbinde...',
        'systemHealthy': 'System Gesund',
        'superAdmin': 'Super Admin',
        'fullAccess': 'Vollzugriff',
        
        // Navigation
        'dashboard': 'Dashboard',
        'systemAnalytics': 'Systemanalyse',
        'userManagement': 'Benutzerverwaltung',
        'apiManagement': 'API-Verwaltung',
        'systemMonitoring': 'Systemüberwachung',
        'securityCenter': 'Sicherheitszentrum',
        'settings': 'Einstellungen',
        'systemLogs': 'Systemprotokolle'
    },
    fr: {
        // Header
        'headerTitle': 'MesChain-Sync Tableau de Bord Super Admin',
        'headerSubtitle': 'Tableau de Bord Super Admin v4.1',
        'quickAccess': 'Accès Rapide',
        'usageGuide': 'Guide d\'Utilisation',
        'techManual': 'Manuel Technique',
        'systemReport': 'Rapport Système',
        'backupManager': 'Gestionnaire de Sauvegarde',
        'themes': 'Thèmes',
        'light': 'Clair',
        'dark': 'Sombre',
        'connecting': 'Connexion...',
        'systemHealthy': 'Système Sain',
        'superAdmin': 'Super Admin',
        'fullAccess': 'Accès Complet',
        
        // Navigation
        'dashboard': 'Tableau de Bord',
        'systemAnalytics': 'Analyses Système',
        'userManagement': 'Gestion des Utilisateurs',
        'apiManagement': 'Gestion API',
        'systemMonitoring': 'Surveillance Système',
        'securityCenter': 'Centre de Sécurité',
        'settings': 'Paramètres',
        'systemLogs': 'Journaux Système'
    }
};

// Language management functions
function toggleLanguageMenu() {
    const menu = document.getElementById('languageMenu');
    if (menu) {
        menu.classList.toggle('hidden');
    }
}

function setLanguage(lang) {
    window.MesChain.currentLanguage = lang;
    localStorage.setItem('meschain-language', lang);
    
    // Update current language display
    const currentLangElement = document.getElementById('currentLanguage');
    if (currentLangElement) {
        currentLangElement.textContent = lang.toUpperCase();
    }
    
    // Update HTML lang attribute
    document.documentElement.lang = lang;
    
    // Apply translations
    applyTranslations();
    
    // Hide language menu
    const languageMenu = document.getElementById('languageMenu');
    if (languageMenu) {
        languageMenu.classList.add('hidden');
    }
    
    // Show notification
    if (typeof showNotification === 'function') {
        showNotification(`Dil değiştirildi: ${lang.toUpperCase()}`, 'success');
    }
}

function applyTranslations() {
    const currentLang = window.MesChain.currentLanguage || 'tr';
    
    // Update all elements with data-tr, data-en, etc. attributes
    const elements = document.querySelectorAll('[data-tr], [data-en], [data-de], [data-fr]');
    
    elements.forEach(element => {
        const translationKey = `data-${currentLang}`;
        const translation = element.getAttribute(translationKey);
        
        if (translation) {
            if (element.tagName === 'INPUT' && element.type === 'text') {
                element.placeholder = translation;
            } else {
                element.textContent = translation;
            }
        }
    });

    // Update elements with translation keys
    if (translations[currentLang]) {
        Object.keys(translations[currentLang]).forEach(key => {
            const elements = document.querySelectorAll(`[data-translate="${key}"]`);
            elements.forEach(element => {
                if (element.tagName === 'INPUT' && element.type === 'text') {
                    element.placeholder = translations[currentLang][key];
                } else {
                    element.textContent = translations[currentLang][key];
                }
            });
        });
    }
}

function setupLanguageDropdown() {
    const languageMenu = document.getElementById('languageMenu');
    const languageToggle = document.getElementById('languageToggle');
    const languageDropdown = document.querySelector('.language-dropdown');
    
    if (languageDropdown && languageMenu && languageToggle) {
        // Remove hidden class initially if it exists
        languageMenu.classList.remove('hidden');
        
        // Setup hover events
        languageDropdown.addEventListener('mouseenter', function() {
            languageMenu.style.opacity = '1';
            languageMenu.style.visibility = 'visible';
            languageMenu.style.transform = 'translateY(0)';
        });
        
        languageDropdown.addEventListener('mouseleave', function() {
            setTimeout(() => {
                if (!languageDropdown.matches(':hover')) {
                    languageMenu.style.opacity = '0';
                    languageMenu.style.visibility = 'hidden';
                    languageMenu.style.transform = 'translateY(-10px)';
                }
            }, 100);
        });
        
        // Setup click events
        languageToggle.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            
            const isVisible = languageMenu.style.opacity === '1';
            if (isVisible) {
                languageMenu.style.opacity = '0';
                languageMenu.style.visibility = 'hidden';
                languageMenu.style.transform = 'translateY(-10px)';
            } else {
                languageMenu.style.opacity = '1';
                languageMenu.style.visibility = 'visible';
                languageMenu.style.transform = 'translateY(0)';
            }
        });
    }
}

// Close menus when clicking outside
function setupLanguageClickOutside() {
    document.addEventListener('click', function(event) {
        const languageMenu = document.getElementById('languageMenu');
        const languageDropdown = document.querySelector('.language-dropdown');
        
        if (languageMenu && languageDropdown && !languageDropdown.contains(event.target)) {
            languageMenu.style.opacity = '0';
            languageMenu.style.visibility = 'hidden';
            languageMenu.style.transform = 'translateY(-10px)';
        }
    });
}

// Initialize language system
function initializeLanguageSystem() {
    const currentLang = localStorage.getItem('meschain-language') || 'tr';
    setLanguage(currentLang);
    
    // Update language display
    const currentLangElement = document.getElementById('currentLanguage');
    if (currentLangElement) {
        currentLangElement.textContent = currentLang.toUpperCase();
    }
    
    // Setup enhanced language dropdown
    setupLanguageDropdown();
    setupLanguageClickOutside();
}

// Make functions globally available
window.toggleLanguageMenu = toggleLanguageMenu;
window.setLanguage = setLanguage;
window.applyTranslations = applyTranslations;
window.initializeLanguageSystem = initializeLanguageSystem;
